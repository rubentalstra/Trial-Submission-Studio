<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <!-- ═══════════════════════════════════════════════════════════════════
         BUNDLE IDENTIFICATION
         ═══════════════════════════════════════════════════════════════════ -->

    <!-- Info.plist format version (always 6.0) -->
    <key>CFBundleInfoDictionaryVersion</key>
    <string>6.0</string>

    <!-- Unique bundle identifier (reverse DNS) -->
    <key>CFBundleIdentifier</key>
    <string>com.rubentalstra.trial-submission-studio</string>

    <!-- Short name for menus and Dock -->
    <key>CFBundleName</key>
    <string>Trial Submission Studio</string>

    <!-- Full display name -->
    <key>CFBundleDisplayName</key>
    <string>Trial Submission Studio</string>

    <!-- Main executable name (must match binary) -->
    <key>CFBundleExecutable</key>
    <string>trial-submission-studio</string>

    <!-- ═══════════════════════════════════════════════════════════════════
         VERSION INFORMATION (Apple-compliant format)
         ═══════════════════════════════════════════════════════════════════ -->

    <!-- Build number (JetBrains-style: TSS-{run}.{commits}) -->
    <key>CFBundleVersion</key>
    <string>${BUILD_VERSION}</string>

    <!-- Marketing version (n.n.n format, no pre-release suffix) -->
    <key>CFBundleShortVersionString</key>
    <string>${MARKETING_VERSION}</string>

    <!-- Human-readable build info (like JetBrains) -->
    <key>CFBundleGetInfoString</key>
    <string>Trial Submission Studio ${MARKETING_VERSION}, build ${BUILD_VERSION}. Copyright Ruben Talstra, (c) 2024-2026</string>

    <!-- ═══════════════════════════════════════════════════════════════════
         BUNDLE METADATA
         ═══════════════════════════════════════════════════════════════════ -->

    <!-- Bundle type (APPL = Application) -->
    <key>CFBundlePackageType</key>
    <string>APPL</string>

    <!-- 4-character creator code (legacy, use ???? for modern apps) -->
    <key>CFBundleSignature</key>
    <string>????</string>

    <!-- Icon file name (without .icns extension) -->
    <key>CFBundleIconFile</key>
    <string>AppIcon</string>

    <!-- Copyright notice -->
    <key>NSHumanReadableCopyright</key>
    <string>Copyright © 2024-2026 Ruben Talstra. All rights reserved.</string>

    <!-- Development region/language -->
    <key>CFBundleDevelopmentRegion</key>
    <string>en</string>

    <!-- Supported platforms -->
    <key>CFBundleSupportedPlatforms</key>
    <array>
        <string>MacOSX</string>
    </array>

    <!-- ═══════════════════════════════════════════════════════════════════
         SYSTEM REQUIREMENTS
         ═══════════════════════════════════════════════════════════════════ -->

    <!-- Minimum macOS version (n.n.n format required) -->
    <key>LSMinimumSystemVersion</key>
    <string>11.0.0</string>

    <!-- High DPI/Retina display support -->
    <key>NSHighResolutionCapable</key>
    <true/>

    <!-- Allow automatic GPU switching (saves battery on MacBooks) -->
    <key>NSSupportsAutomaticGraphicsSwitching</key>
    <true/>

    <!-- Prefer Apple Silicon architecture -->
    <key>LSArchitecturePriority</key>
    <array>
        <string>arm64</string>
        <string>x86_64</string>
    </array>

    <!-- Force native execution (no Rosetta when native available) -->
    <key>LSRequiresNativeExecution</key>
    <true/>

    <!-- ═══════════════════════════════════════════════════════════════════
         PRIVACY / TCC USAGE DESCRIPTIONS (Required for macOS 10.14+)
         These prevent silent app termination when accessing protected resources
         ═══════════════════════════════════════════════════════════════════ -->

    <!-- File access descriptions (for native file dialogs and drag-drop) -->
    <key>NSDesktopFolderUsageDescription</key>
    <string>Trial Submission Studio needs access to your Desktop to import and export clinical trial data files.</string>

    <key>NSDocumentsFolderUsageDescription</key>
    <string>Trial Submission Studio needs access to your Documents folder to import and export clinical trial data files.</string>

    <key>NSDownloadsFolderUsageDescription</key>
    <string>Trial Submission Studio needs access to your Downloads folder to export XPT and other clinical trial output files.</string>

    <!-- Removable volumes (USB drives with clinical trial data) -->
    <key>NSRemovableVolumesUsageDescription</key>
    <string>Trial Submission Studio needs access to removable drives to import clinical trial data from external storage devices.</string>

    <!-- Network volumes (shared drives in clinical environments) -->
    <key>NSNetworkVolumesUsageDescription</key>
    <string>Trial Submission Studio needs access to network volumes to import clinical trial data from shared storage.</string>

    <!-- Local network (for GitHub update checks) -->
    <key>NSLocalNetworkUsageDescription</key>
    <string>Trial Submission Studio uses the network to check for software updates from GitHub.</string>

    <!-- ═══════════════════════════════════════════════════════════════════
         APP STORE METADATA
         ═══════════════════════════════════════════════════════════════════ -->

    <!-- App Store category: Medical (for clinical trial software) -->
    <key>LSApplicationCategoryType</key>
    <string>public.app-category.medical</string>

    <!-- Secure state restoration support -->
    <key>LSSupportsSecureStateRestoration</key>
    <true/>

    <!-- Principal class for Cocoa apps -->
    <key>NSPrincipalClass</key>
    <string>NSApplication</string>

    <!-- ═══════════════════════════════════════════════════════════════════
         CUSTOM UTI DECLARATIONS
         ═══════════════════════════════════════════════════════════════════ -->

    <!-- Export XPT as a custom UTI since it's not system-defined -->
    <key>UTExportedTypeDeclarations</key>
    <array>
        <dict>
            <!-- Unique UTI identifier -->
            <key>UTTypeIdentifier</key>
            <string>com.sas.xpt</string>

            <!-- Human-readable description -->
            <key>UTTypeDescription</key>
            <string>SAS Transport File (XPT)</string>

            <!-- Conformance hierarchy (required for file types) -->
            <key>UTTypeConformsTo</key>
            <array>
                <string>public.data</string>
            </array>

            <!-- File extension mapping -->
            <key>UTTypeTagSpecification</key>
            <dict>
                <key>public.filename-extension</key>
                <array>
                    <string>xpt</string>
                </array>
                <key>public.mime-type</key>
                <array>
                    <string>application/x-sas-xport</string>
                </array>
            </dict>

            <!-- Reference URL for the format -->
            <key>UTTypeReferenceURL</key>
            <string>https://support.sas.com/techsup/technote/ts140.pdf</string>
        </dict>
    </array>

    <!-- ═══════════════════════════════════════════════════════════════════
         DOCUMENT TYPE ASSOCIATIONS
         ═══════════════════════════════════════════════════════════════════ -->

    <key>CFBundleDocumentTypes</key>
    <array>
        <!-- CSV files (read-only viewer) -->
        <dict>
            <key>CFBundleTypeName</key>
            <string>CSV Document</string>
            <key>CFBundleTypeRole</key>
            <string>Viewer</string>
            <key>LSHandlerRank</key>
            <string>Alternate</string>
            <key>LSItemContentTypes</key>
            <array>
                <string>public.comma-separated-values-text</string>
            </array>
        </dict>
        <!-- XPT files (full editor) -->
        <dict>
            <key>CFBundleTypeName</key>
            <string>SAS Transport File</string>
            <key>CFBundleTypeRole</key>
            <string>Editor</string>
            <key>LSHandlerRank</key>
            <string>Owner</string>
            <key>LSItemContentTypes</key>
            <array>
                <string>com.sas.xpt</string>
            </array>
            <key>CFBundleTypeIconFile</key>
            <string>AppIcon</string>
        </dict>
    </array>

    <!-- ═══════════════════════════════════════════════════════════════════
         NETWORK SECURITY (App Transport Security)
         ═══════════════════════════════════════════════════════════════════ -->

    <key>NSAppTransportSecurity</key>
    <dict>
        <!-- Only allow connections to explicitly listed domains -->
        <key>NSExceptionDomains</key>
        <dict>
            <!-- GitHub API for update checking -->
            <key>github.com</key>
            <dict>
                <key>NSIncludesSubdomains</key>
                <true/>
                <key>NSExceptionMinimumTLSVersion</key>
                <string>TLSv1.2</string>
                <key>NSExceptionRequiresForwardSecrecy</key>
                <true/>
            </dict>
        </dict>
    </dict>
</dict>
</plist>
